(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e4d3c37e"],{"0b87":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"projectManage"},[r("div",{staticClass:"leftMenu"},[r("menuList",{attrs:{menuObj:e.menuObj},on:{clickMenu:e.selectMenu}})],1),r("div",{staticClass:"rightList"},[r("p",{staticClass:"rightTit clearfix"},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addPro}},[e._v("新增")])],1),r("div",{staticClass:"tableCon"},[r("tableBox",{ref:"table",attrs:{dataList:e.dataList,headerList:e.headerList,actionType:"project"},on:{editRow:e.editRow,deleteRow:e.deleteRow,checkRow:e.checkRow}})],1)])])},o=[],i=r("5530"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"menuList"},[r("p",{staticClass:"menuTit itemNum clearfix",class:"all"==e.currentIndex?"active":"",on:{click:function(t){return e.handleClickMenu({type:"all"})}}},[r("span",[e._v(e._s(e.menuObj.title))]),r("i",[e._v(e._s(e.menuObj.total))])]),r("ul",{staticClass:"menuCon"},e._l(e.menuObj.menuList,(function(t,a){return r("li",{key:a,staticClass:"menuItem itemNum clearfix",class:e.currentIndex==t.type?"active":"",on:{click:function(r){return e.handleClickMenu(t,a)}}},[r("span",[e._v(e._s(t.label))]),r("i",[e._v(e._s(t.count))])])})),0)])},l=[],s={name:"menuList",props:{menuObj:{type:Object,default:function(){return{title:"",total:0,menuList:[],active:"all"}}}},data:function(){return{currentIndex:"all"}},watch:{menuObj:{handler:function(e){this.currentIndex=e.active},deep:!0}},methods:{addMenu:function(){},handleClickMenu:function(e){this.currentIndex=e.type,console.log(e),this.$emit("clickMenu",e)}}},c=s,u=(r("2f75"),r("2877")),p=Object(u["a"])(c,n,l,!1,null,"82636c7a",null),m=p.exports,d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"tableBox",staticClass:"tableBox"},[r("el-table",{ref:"mainTable",attrs:{data:e.dataList,height:e.tableHeight,border:""}},[e._l(e.headerList,(function(t){return r("el-table-column",{key:t.code,attrs:{label:t.name},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v(" "+e._s(r.row[t.code]?r.row[t.code]:"--")+" ")]}}],null,!0)})})),r("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.handleCheck(t.row)}}},[e._v("查看")]),r("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.handleEdit(t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"danger"},on:{click:function(r){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],2)],1)},f=[],h={name:"tableBox",props:{actionType:{type:String,default:function(){return""}},tablePag:{type:Object,default:function(){return{pageNo:1,pageSize:15,totalRecord:0}}},headerList:{type:Array,default:function(){return[]}},dataList:{props:Array,default:[]}},data:function(){return{tableHeight:300}},methods:{handleCurrentChange:function(e){this.$emit("changePageNo",e)},handleCheck:function(e){this.$emit("checkRow",e)},handleEdit:function(e){this.$emit("editRow",e)},handleDelete:function(e){this.$emit("deleteRow",e)},handleAction:function(e){this.$emit("newBranch",e)},setTableHeight:function(){var e=this;this.$nextTick((function(){e.tableHeight=e.$refs.tableBox.offsetHeight}))},doLay:function(){this.$refs.mainTable.doLayout()}},mounted:function(){var e=this;this.$nextTick((function(){e.setTableHeight()}))}},b=h,v=(r("3104"),Object(u["a"])(b,d,f,!1,null,"43f6784b",null)),g=v.exports,y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.proVisible?r("el-dialog",{attrs:{visible:e.proVisible,width:"40%",title:e.title,"before-close":e.close,"close-on-click-modal":!1}},[r("el-form",{ref:"proForm",attrs:{model:e.proForm,rules:e.proRules,"label-width":"100px","label-position":"left"}},["add"==e.$props.type?r("el-form-item",{attrs:{label:"新增方式"}},[r("el-radio-group",{model:{value:e.proForm.addMethod,callback:function(t){e.$set(e.proForm,"addMethod",t)},expression:"proForm.addMethod"}},[r("el-radio",{attrs:{label:"localImport"}},[e._v("本地导入")]),r("el-radio",{attrs:{label:"createNew"}},[e._v("创建新服务")])],1)],1):e._e(),"createNew"==e.proForm.addMethod||e.proForm.templateUrl?r("el-form-item",{attrs:{label:"选择模板"}},[r("el-row",{attrs:{type:"flex"}},[r("el-col",{attrs:{span:12}},[r("el-input",{attrs:{readonly:"",placeholder:"模板路径"},model:{value:e.proForm.templateUrl,callback:function(t){e.$set(e.proForm,"templateUrl",t)},expression:"proForm.templateUrl"}})],1),r("el-col",{attrs:{span:3,offset:1}},[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.selectTem}},[e._v("选择模板")])],1)],1)],1):e._e(),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"服务名称",prop:"projectName"}},[r("el-input",{attrs:{placeholder:"请输入服务名称"},model:{value:e.proForm.projectName,callback:function(t){e.$set(e.proForm,"projectName",t)},expression:"proForm.projectName"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"文件名称",prop:"fileName"}},[r("el-input",{attrs:{placeholder:"请输入文件名称"},model:{value:e.proForm.fileName,callback:function(t){e.$set(e.proForm,"fileName",t)},expression:"proForm.fileName"}})],1)],1)],1),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"服务类型",prop:"type"}},[r("el-select",{staticStyle:{width:"100%"},model:{value:e.proForm.type,callback:function(t){e.$set(e.proForm,"type",t)},expression:"proForm.type"}},e._l(e.typeList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"服务路径",prop:"pathUrl"}},[r("el-input",{attrs:{type:"text",placeholder:"请输入服务所在父目录路径"},model:{value:e.proForm.pathUrl,callback:function(t){e.$set(e.proForm,"pathUrl",t)},expression:"proForm.pathUrl"}})],1)],1)],1),r("el-form-item",{attrs:{label:"图片说明"}},[r("el-upload",{staticClass:"upload-demo",attrs:{action:"/api/upload",accept:"image/jpeg,image/gif,image/png,image/jpg",limit:1,multiple:!1,"on-success":e.getFile}},[r("el-button",{staticClass:"el-icon-plus",attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),r("el-form-item",{attrs:{label:"Git路径",prop:"gitUrl"}},[r("el-input",{attrs:{type:"text",placeholder:"请输入Git路径"},model:{value:e.proForm.gitUrl,callback:function(t){e.$set(e.proForm,"gitUrl",t)},expression:"proForm.gitUrl"}})],1),r("el-form-item",{attrs:{label:"关键字",prop:"keyword"}},[r("el-input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.proForm.keyword,callback:function(t){e.$set(e.proForm,"keyword",t)},expression:"proForm.keyword"}})],1),r("el-form-item",{attrs:{label:"服务描述"}},[r("el-input",{attrs:{type:"textarea",rows:2,placeholder:"服务描述"},model:{value:e.proForm.dec,callback:function(t){e.$set(e.proForm,"dec",t)},expression:"proForm.dec"}})],1),r("el-row",{attrs:{type:"flex",justify:"end"}},[r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确认")]),r("el-button",{attrs:{type:"info"},on:{click:e.close}},[e._v("取消")])],1)],1)],1),r("selectTem",{ref:"selectTem",model:{value:e.proForm.templateUrl,callback:function(t){e.$set(e.proForm,"templateUrl",t)},expression:"proForm.templateUrl"}})],1):e._e()},j=[],k=r("d093"),$={name:"proDialog",props:["itemObj","type"],data:function(){return{proVisible:!1,proForm:{addMethod:"localImport",projectName:"",type:"",pathUrl:"",gitUrl:"",keyword:"",dec:"",templateUrl:"",decImg:"",fileName:""},proRules:{projectName:[{required:!0,message:"请输入服务名称",trigger:"blur"}],fileName:[{required:!0,message:"请输入文件名称",trigger:"blur"}],type:[{required:!0,message:"请输入服务类型",trigger:"change"}],pathUrl:[{required:!0,message:"请输入服务路径",trigger:"blur"}],gitUrl:[{required:!0,message:"请输入Git路径",trigger:"blur"}],keyword:[{required:!0,message:"请输入关键字",trigger:"blur"}]},typeList:[]}},methods:{getFile:function(e){this.proForm.decImg=e.resultEntity},show:function(){this.title="modify"==this.$props.type?"修改服务":"新增服务","modify"==this.$props.type?this.proForm=this.$props.itemObj:this.proForm={addMethod:"localImport",projectName:"",type:"",pathUrl:"",gitUrl:"",keyword:"",dec:"",templateUrl:""},this.proVisible=!0,this.queryProTypeList()},close:function(){this.proVisible=!1,this.$refs.proForm.resetFields()},queryProTypeList:function(){var e=this;Object(k["e"])({}).then((function(t){e.typeList=t||[]}))},selectTem:function(){this.$refs.selectTem.show()},confirm:function(){var e=this;this.$refs.proForm.validate((function(t){t&&("add"==e.$props.type?Object(k["a"])(e.proForm).then((function(){e.$message({type:"success",message:"新增成功！"}),"createNew"===e.proForm.addMethod?e.$confirm("如果本地存在相同文件夹，本地文件将被删除请谨慎操作").then((function(){e.$router.push({path:"/project/projectInit",query:e.proForm}),e.close()})).catch((function(){})):(e.$emit("getList",e.proForm.type),e.close())})):updateProject(e.proForm).then((function(){e.$message({type:"success",message:"修改成功！"}),e.$emit("getList"),e.close()})))}))}}},x=$,w=(r("63d0"),Object(u["a"])(x,y,j,!1,null,"2912829c",null)),F=w.exports,_=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"cardTemp"},[r("el-row",{attrs:{gutter:20}},e._l(e.compCardList,(function(t){return r("el-col",{key:t.projectId,attrs:{span:8}},[r("div",{staticClass:"templateCard"},[r("img",{staticClass:"cardImg",attrs:{src:t.decImg?t.decImg:e.bg}}),r("div",{staticClass:"cardBody"},[r("h4",{staticClass:"cardTit"},[e._v(e._s(t.projectName))]),r("p",{staticClass:"cardText"},[e._v(e._s(t.dec))]),r("el-form",{ref:"form",refInFor:!0,staticStyle:{"margin-top":"10px"},attrs:{model:e.form,"label-width":"40px"}},[r("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"操作"}},[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(r){return e.update(t)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(r){return e.deleteAtion(t)}}},[e._v("删除")])],1),r("el-form-item",{attrs:{label:"Git"}},[r("el-row",{attrs:{gutter:10,type:"flex"}},[r("el-col",{attrs:{span:10}},[r("el-select",{attrs:{placeholder:"请选择类型"},model:{value:t.action,callback:function(r){e.$set(t,"action",r)},expression:"item.action"}},e._l(t.actions,(function(e,t){return r("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-col",{staticStyle:{display:"flex"},attrs:{span:14}},[r("el-input",{model:{value:t.param,callback:function(r){e.$set(t,"param",r)},expression:"item.param"}}),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(r){return e.action(t)}}},[e._v("执行")])],1)],1)],1)],1)],1)])])})),1)],1)},O=[],L=(r("498a"),{name:"templateCard",props:{tablePag:{type:Object,default:function(){return{pageNo:1,pageSize:15,totalRecord:0}}},compCardList:{type:Array,default:function(){return[]}}},data:function(){return{form:{region:"1",param:""},itemObj:null,actionType:"modify",bg:r("b7ef")}},methods:{action:function(e){e.param?(e.param=e.param.trim(),this.$emit("action",Object.assign(e))):this.$message({type:"warning",mes:"请填写参数！"})},deleteAtion:function(e){this.$emit("delete",e)},handleCurrentChange:function(e){this.$emit("changePageNo",e)},getTempList:function(){this.$emit("getTempList")},update:function(e){this.$emit("edit",e)}}}),C=L,T=(r("c505"),Object(u["a"])(C,_,O,!1,null,"58b30357",null)),N=T.exports,U={name:"projectManage",data:function(){return{type:"add",menuObj:{title:"服务总计",total:0,menuList:[],active:"all"},tablePag:{pageNo:1,pageSize:15,totalRecord:0},dataList:[],headerList:[{name:"服务名称",code:"serviceName"},{name:"服务地址",code:"serviceAddress"},{name:"监控检查接口",code:"useConsulCheckPath"},{name:"熔断阈值",code:"serviceBreak"},{name:"限流阈值",code:"serviceLimit"}],keyword:"",itemObj:{},proFormObj:{}}},components:{menuList:m,tableBox:g,proDialog:F,compCard:N},methods:{addPro:function(){this.$router.push({name:"projectAdd",query:{type:"add"}})},selectMenu:function(e){var t=this,r={};e?(this.itemObj=e,r={type:e.value}):r={type:"all"},Object(k["c"])(r).then((function(e){t.dataList=e.serverList||[],t.$forceUpdate()}))},queryProList:function(){var e=this;Object(k["d"])({}).then((function(t){e.menuObj.total=t.sum||0,e.menuObj.menuList=t.serverList||[],e.$nextTick((function(){e.selectMenu()}))}))},deleteRow:function(e){var t=this;this.$confirm("确认删除此服务？").then((function(){Object(k["b"])({serviceId:e.serviceId}).then((function(){t.$message({type:"success",message:"删除成功"}),t.selectMenu(e)}))})).catch((function(){}))},editRow:function(e){this.$router.push({name:"projectAdd",query:{id:e.serverId,type:"edit"}})},checkRow:function(e){this.$router.push({name:"projectAdd",query:{id:e.serverId,type:"check"}})}},mounted:function(){this.queryProList(!0)},created:function(){}},I=Object(i["a"])({},U),M=I,S=(r("9af4"),Object(u["a"])(M,a,o,!1,null,"7bab62a1",null));t["default"]=S.exports},"2f75":function(e,t,r){"use strict";var a=r("458c"),o=r.n(a);o.a},3104:function(e,t,r){"use strict";var a=r("911a"),o=r.n(a);o.a},4120:function(e,t,r){},4250:function(e,t,r){},"458c":function(e,t,r){},"498a":function(e,t,r){"use strict";var a=r("23e7"),o=r("58a8").trim,i=r("c8d2");a({target:"String",proto:!0,forced:i("trim")},{trim:function(){return o(this)}})},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var a=r("1d80"),o=r("5899"),i="["+o+"]",n=RegExp("^"+i+i+"*"),l=RegExp(i+i+"*$"),s=function(e){return function(t){var r=String(a(t));return 1&e&&(r=r.replace(n,"")),2&e&&(r=r.replace(l,"")),r}};e.exports={start:s(1),end:s(2),trim:s(3)}},"5ee0":function(e,t,r){},"63d0":function(e,t,r){"use strict";var a=r("4120"),o=r.n(a);o.a},"911a":function(e,t,r){},"9af4":function(e,t,r){"use strict";var a=r("4250"),o=r.n(a);o.a},b7ef:function(e,t,r){e.exports=r.p+"static/img/bg.21ceae9e.jpg"},c505:function(e,t,r){"use strict";var a=r("5ee0"),o=r.n(a);o.a},c8d2:function(e,t,r){var a=r("d039"),o=r("5899"),i="​᠎";e.exports=function(e){return a((function(){return!!o[e]()||i[e]()!=i||o[e].name!==e}))}},d093:function(e,t,r){"use strict";r.d(t,"d",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"e",(function(){return n})),r.d(t,"a",(function(){return l})),r.d(t,"f",(function(){return s})),r.d(t,"g",(function(){return c})),r.d(t,"b",(function(){return u}));var a=r("b775");function o(){return Object(a["a"])({url:"/uiApi/v1/service/serviceSum",method:"GET"})}function i(e){return Object(a["a"])({url:"/uiApi/v1/service/serviceList",method:"GET",params:e})}function n(){return Object(a["a"])({url:"/uiApi/v1/eumn/serverTypeList",method:"GET"})}function l(e){return Object(a["a"])({url:"/uiApi/v1/service/addService",method:"POST",params:e})}function s(e){return Object(a["a"])({url:"/uiApi/v1/service/serviceDetail?serverId=".concat(e),method:"GET"})}function c(e){return Object(a["a"])({url:"/uiApi/v1/service/editService",method:"POST",params:e})}function u(e){return Object(a["a"])({url:"/uiApi/v1/service/deleteService",method:"POST",params:e})}}}]);